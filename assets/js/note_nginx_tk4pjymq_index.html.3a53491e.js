"use strict";(self.webpackChunkunravely_blog=self.webpackChunkunravely_blog||[]).push([[487],{7619:(s,i,a)=>{a.r(i),a.d(i,{comp:()=>e,data:()=>h});var n=a(6254);const l={},e=(0,a(1021).A)(l,[["render",function(s,i){return(0,n.uX)(),(0,n.CE)("div",null,i[0]||(i[0]=[(0,n.Fv)('<h2 id="用于http和server配置块中的location-部分" tabindex="-1"><a class="header-anchor" href="#用于http和server配置块中的location-部分"><span>用于http和server配置块中的location 部分</span></a></h2><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">1.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_pass</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 指定代理请求的上游服务器的地址。可以是</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HTTP、HTTPS、或</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> TCP</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 服务器地址。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_pass</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> http://backend_server</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">2.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_set_header</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 设置转发到上游服务器的请求头部。可以用来修改、添加或删除请求头部。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_set_header</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Host</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $host</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> proxy_set_header</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> X-Real-IP</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $remote_addr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> proxy_set_header</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> X-Forwarded-For</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $proxy_add_x_forwarded_for</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">3.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_ignore_headers</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 指定在上游服务器的响应中忽略哪些响应头部。用于控制</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Nginx</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 是否处理这些头部。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_ignore_headers</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> X-Accel-Expires</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Expires</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Cache-Control</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">4.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_hide_header</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 从返回给客户端的响应中隐藏指定的响应头部。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_hide_header</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> X-Powered-By</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">5.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_set_header</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 指定用于与上游服务器进行连接的请求头部。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_set_header</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Host</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $host</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> proxy_set_header</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> X-Real-IP</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $remote_addr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> proxy_set_header</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> X-Forwarded-For</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $proxy_add_x_forwarded_for</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">6.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_read_timeout</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 设置从上游服务器读取响应的超时时间。超时后，Nginx</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 会关闭连接。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_read_timeout</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 90s</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">7.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_connect_timeout</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 设置与上游服务器建立连接的超时时间。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_connect_timeout</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 30s</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">8.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_send_timeout</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 设置向上游服务器发送请求的超时时间。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_send_timeout</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 30s</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">9.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_buffer_size</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 设置用于保存上游服务器响应头部的缓冲区大小。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_buffer_size</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 4k</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">10.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_buffers</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 设置用于保存上游服务器响应的缓冲区数量和每个缓冲区的大小。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_buffers</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 8</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 16k</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">11.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_busy_buffers_size</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 设置允许在请求处理中使用的“忙碌”缓冲区的最大大小。这有助于在高负载情况下减少内存使用。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_busy_buffers_size</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 64k</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">12.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_temp_file_write_size</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 设置在将响应写入临时文件时的最大块大小。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_temp_file_write_size</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 64k</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">13.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_max_temp_file_size</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 设置用于保存临时文件的最大大小。如果响应超过此大小，将被写入到磁盘。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_max_temp_file_size</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 1024m</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">14.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_cache</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 启用或禁用缓存功能。指定缓存区域名称。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_cache</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> my_cache_zone</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">15.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_cache_path</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 定义缓存区域的存储路径和缓存参数。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_cache_path</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /data/nginx/cache</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> levels=1:2</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> keys_zone=my_cache_zone:10m</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> max_size=1g</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">16.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_cache_valid</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 定义缓存的有效时间。可以根据不同的</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HTTP</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 状态码设置不同的有效时间。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_cache_valid</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 200</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 302</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 10m</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> proxy_cache_valid</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 404</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 1m</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">17.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_cache_bypass</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 指定在某些条件下绕过缓存。可以使用变量来控制。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_cache_bypass</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $http_cache_control</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">18.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_cache_key</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 定义缓存的键。用于唯一标识缓存条目。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_cache_key</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">$scheme$request_method$host$request_uri</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">19.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_redirect</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 修改从上游服务器返回的</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Location</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 和</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Refresh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 头部。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_redirect</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> http://backend_server/</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">20.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_pass_request_headers</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 控制是否将客户端请求中的所有头部转发给上游服务器。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_pass_request_headers</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> on</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">21.</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_pass_request_body</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">含义:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 控制是否将客户端请求体转发给上游服务器。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_pass_request_body</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> on</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="proxy-set-header的设置" tabindex="-1"><a class="header-anchor" href="#proxy-set-header的设置"><span>proxy_set_header的设置</span></a></h2><p>proxy_set_header 指令在 Nginx 作为反向代理服务器时，用于设置或修改传递给后端服务器的 HTTP 头部。其作用是确保后端服务器能够接收到正确的请求信息</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">proxy_set_header</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Host</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $host</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">作用:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 将原始请求中的</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Host</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 头部传递给后端服务器，保持客户端请求的主机名。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_set_header</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Host</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $host</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">proxy_set_header</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> X-Real-IP</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $remote_addr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">作用:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 将客户端的真实</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> IP</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 地址传递给后端服务器，后端服务器可以获取到客户端的实际</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> IP</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 地址。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_set_header</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> X-Real-IP</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $remote_addr</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">proxy_set_header</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> X-Forwarded-For</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $proxy_add_x_forwarded_for</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">作用:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 添加或更新</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> X-Forwarded-For</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 头部，通常包含客户端的</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> IP</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 地址及通过的代理服务器</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> IP</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 地址链。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_set_header</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> X-Forwarded-For</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $proxy_add_x_forwarded_for</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">proxy_set_header</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> X-Forwarded-Proto</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $scheme</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">作用:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 将请求的协议（HTTP</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 或</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> HTTPS）传递给后端服务器，后端可以知道请求是通过哪个协议发起的。</span></span>\n<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">示例:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> proxy_set_header</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> X-Forwarded-Proto</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> $scheme</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',5)]))}]]),h=JSON.parse('{"path":"/note_nginx/tk4pjymq/","title":"代理指令及解释","lang":"zh-CN","frontmatter":{"title":"代理指令及解释","createTime":"2024/11/20 18:00:04","permalink":"/note_nginx/tk4pjymq/","description":"用于http和server配置块中的location 部分 proxy_set_header的设置 proxy_set_header 指令在 Nginx 作为反向代理服务器时，用于设置或修改传递给后端服务器的 HTTP 头部。其作用是确保后端服务器能够接收到正确的请求信息","head":[["meta",{"property":"og:url","content":"https://www.unravely.press/note_nginx/tk4pjymq/"}],["meta",{"property":"og:site_name","content":"Unravely"}],["meta",{"property":"og:title","content":"代理指令及解释"}],["meta",{"property":"og:description","content":"用于http和server配置块中的location 部分 proxy_set_header的设置 proxy_set_header 指令在 Nginx 作为反向代理服务器时，用于设置或修改传递给后端服务器的 HTTP 头部。其作用是确保后端服务器能够接收到正确的请求信息"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-11-21T10:08:35.000Z"}],["meta",{"property":"article:modified_time","content":"2024-11-21T10:08:35.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"代理指令及解释\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-11-21T10:08:35.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"用于http和server配置块中的location 部分","slug":"用于http和server配置块中的location-部分","link":"#用于http和server配置块中的location-部分","children":[]},{"level":2,"title":"proxy_set_header的设置","slug":"proxy-set-header的设置","link":"#proxy-set-header的设置","children":[]}],"readingTime":{"minutes":3.28,"words":985},"git":{"createdTime":1732098709000,"updatedTime":1732183715000,"contributors":[{"name":"banxia","email":"yutong9717@163.com","commits":2}]},"autoDesc":true,"filePathRelative":"notes/note_nginx/代理指令及解释.md","bulletin":false}')}}]);